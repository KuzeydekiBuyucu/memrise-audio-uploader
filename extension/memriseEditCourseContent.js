var WordRow = function (element) {    this.$element = $(element);    this.word = this.$element        .find('td.cell.text.column[data-key="1"]')        .find('div.text')        .text();    this.$audioCell = this.$element.find('td.cell.audio.column');    this.audioCellId = this.$audioCell.attr('data-key');    var $audiosMenu = this.$audioCell.find('div.dropdown-menu.audios');    this.hasSound = $audiosMenu.length && $audiosMenu.children().length > 0;    this.thingId = this.$element.attr('data-thing-id');};WordRow.prototype.replaceAudioCell = function(html) {    this.$audioCell.replaceWith($(html));};WordRow.prototype.audioCellAddErrorMsg = function() {    var errorSpan = $("<span>")        .text('Error')        .css('color: red');    this.$audioCell.prepend(errorSpan);    setTimeout(function () {        errorSpan.remove();    }, 1500)};var MemriseCourse = function () {    this.rows = undefined;    this.wordsLanguage = undefined;    this.middlewareToken = undefined;};MemriseCourse.prototype.readRows = function () {    var $table = $('table.level-things.table');    var $rows = $table.find('tr.thing');    this.wordsLanguage = $table.find('th.column[data-key="1"]').find('span.txt').text();    this.rows = [];    $rows.each(function (index, $row) {        this.rows.push(new WordRow($row));    }.bind(this));};MemriseCourse.prototype.grabMemriseToken = function () {    document.addEventListener('mau-set-memrise-token', function (event) {        this.middlewareToken = event.detail;    }.bind(this));    var th = document.getElementsByTagName('body')[0];    var s = document.createElement('script');    s.setAttribute('type', 'text/javascript');    s.setAttribute('src', chrome.extension.getURL('pageInjectedScript.js'));    th.appendChild(s);};MemriseCourse.prototype.uploadSound = function(row, sound) {    var data = new FormData();    data.append('f', new Blob([sound], { type: "audio/mp3" }), "sound.mp3");    data.append('thing_id', row.thingId);    data.append('csrfmiddlewaretoken', this.middlewareToken);    data.append('cell_type', 'column');    data.append('cell_id', row.audioCellId);    var ajaxOptions = {        url: 'https://www.memrise.com/ajax/thing/cell/upload_file/',        data: data,        headers: {'Upgrade-Insecure-Requests': '1'},        cache: false,        contentType: false,        processData: false,        type: 'POST'    };    return $.ajax(ajaxOptions);};var memriseCourse = new MemriseCourse();memriseCourse.grabMemriseToken();